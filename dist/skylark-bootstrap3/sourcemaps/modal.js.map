{"version":3,"sources":["modal.js"],"names":["define","langx","browser","eventer","noder","geom","$","plugins","bs3","Modal","Plugin","inherit","klassName","pluginName","_construct","element","options","this","$container","container","document","body","$element","$dialog","find","is","css","$backdrop","isShown","originalBodyPad","scrollbarWidth","ignoreBackdropClick","remote","load","proxy","trigger","toggle","_relatedTarget","hide","show","that","e","create","relatedTarget","isDefaultPrevented","checkScrollbar","setScrollbar","addClass","escape","resize","on","one","target","backdrop","transition","support","hasClass","isChildOf","appendTo","scrollTop","adjustDialog","offsetWidth","enforceFocus","emulateTransitionEnd","TRANSITION_DURATION","preventDefault","off","removeClass","hideModal","has","length","keyboard","which","window","handleUpdate","resetAdjustments","resetScrollbar","removeBackdrop","remove","callback","animate","doAnimate","createElement","currentTarget","focus","BACKDROP_TRANSITION_DURATION","callbackRemove","modalIsOverflowing","scrollHeight","documentElement","clientHeight","paddingLeft","bodyIsOverflowing","paddingRight","fullWindowWidth","innerWidth","documentElementRect","getBoundingClientRect","right","Math","abs","left","clientWidth","measureScrollbar","bodyPad","parseInt","style","scrollDiv","className","append","removeChild","VERSION","DEFAULTS","register","fn","modal","each","$this","plugin","instantiate","mixin","data","option","test"],"mappings":"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","file":"../modal.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-utils-dom/browser\",\n  \"skylark-utils-dom/eventer\",\n  \"skylark-utils-dom/noder\",\n  \"skylark-utils-dom/geom\",\n  \"skylark-utils-dom/query\",\n  \"skylark-utils-dom/plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n/* ========================================================================\n * Bootstrap: modal.js v3.3.7\n * http://getbootstrap.com/javascript/#modals\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // MODAL CLASS DEFINITION\n  // ======================\n\n  var Modal = bs3.Modal = plugins.Plugin.inherit({\n    klassName: \"Modal\",\n\n    pluginName : \"bs3.modal\",\n\n    _construct : function(element,options) {\n      this.options             = options;\n      this.$container               = $(options.container || document.body)\n      this.$element            = $(element)\n      this.$dialog             = this.$element.find('.modal-dialog')\n      if (!this.$container.is(\"body\")) {\n        this.$element.css(\"position\",\"absolute\");\n      }\n      //this.$container.append(this.$element);\n      this.$backdrop           = null\n      this.isShown             = null\n      this.originalBodyPad     = null\n      this.scrollbarWidth      = 0\n      this.ignoreBackdropClick = false\n\n      if (this.options.remote) {\n        this.$element\n          .find('.modal-content')\n          .load(this.options.remote, langx.proxy(function () {\n            this.$element.trigger('loaded.bs.modal')\n          }, this))\n      }\n    },\n\n    toggle : function (_relatedTarget) {\n      return this.isShown ? this.hide() : this.show(_relatedTarget)\n    },\n\n    show : function (_relatedTarget) {\n      var that = this\n      var e    = eventer.create('show.bs.modal', { relatedTarget: _relatedTarget })\n\n      this.$element.trigger(e)\n\n      if (this.isShown || e.isDefaultPrevented()) return\n\n      this.isShown = true\n\n      this.checkScrollbar()\n      this.setScrollbar()\n      this.$container.addClass('modal-open')\n\n      this.escape()\n      this.resize()\n\n      this.$element.on('click.dismiss.bs.modal', '[data-dismiss=\"modal\"]', langx.proxy(this.hide, this))\n\n      this.$dialog.on('mousedown.dismiss.bs.modal', function () {\n        that.$element.one('mouseup.dismiss.bs.modal', function (e) {\n          if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true\n        })\n      })\n\n      this.backdrop(function () {\n        var transition = browser.support.transition && that.$element.hasClass('fade')\n\n        if (!noder.isChildOf(that.$element[0],that.$container[0])) {\n          that.$element.appendTo(that.$container) // don't move modals dom position\n        }\n\n        that.$element\n          .show()\n          .scrollTop(0)\n\n        that.adjustDialog()\n\n        if (transition) {\n          that.$element[0].offsetWidth // force reflow\n        }\n\n        that.$element.addClass('in')\n\n        that.enforceFocus()\n\n        var e = eventer.create('shown.bs.modal', { relatedTarget: _relatedTarget })\n\n        transition ?\n          that.$dialog // wait for modal to slide in\n            .one('transitionEnd', function () {\n              that.$element.trigger('focus').trigger(e)\n            })\n            .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n          that.$element.trigger('focus').trigger(e)\n      })\n    },\n\n    hide : function (e) {\n      if (e) e.preventDefault()\n\n      e = eventer.create('hide.bs.modal')\n\n      this.$element.trigger(e)\n\n      if (!this.isShown || e.isDefaultPrevented()) return\n\n      this.isShown = false\n\n      this.escape()\n      this.resize()\n\n      $(document).off('focusin.bs.modal')\n\n      this.$element\n        .removeClass('in')\n        .off('click.dismiss.bs.modal')\n        .off('mouseup.dismiss.bs.modal')\n\n      this.$dialog.off('mousedown.dismiss.bs.modal')\n\n      browser.support.transition && this.$element.hasClass('fade') ?\n        this.$element\n          .one('transitionEnd', langx.proxy(this.hideModal, this))\n          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n        this.hideModal()\n    },\n\n    enforceFocus : function () {\n      $(document)\n        .off('focusin.bs.modal') // guard against infinite focus loop\n        .on('focusin.bs.modal', langx.proxy(function (e) {\n          if (document !== e.target &&\n              this.$element[0] !== e.target &&\n              !this.$element.has(e.target).length) {\n            this.$element.trigger('focus')\n          }\n        }, this))\n    },\n\n    escape : function () {\n      if (this.isShown && this.options.keyboard) {\n        this.$element.on('keydown.dismiss.bs.modal', langx.proxy(function (e) {\n          e.which == 27 && this.hide()\n        }, this))\n      } else if (!this.isShown) {\n        this.$element.off('keydown.dismiss.bs.modal')\n      }\n    },\n\n    resize : function () {\n      if (this.isShown) {\n        $(window).on('resize.bs.modal', langx.proxy(this.handleUpdate, this))\n      } else {\n        $(window).off('resize.bs.modal')\n      }\n    },\n\n    hideModal : function () {\n      var that = this\n      this.$element.hide()\n      this.backdrop(function () {\n        that.$container.removeClass('modal-open')\n        that.resetAdjustments()\n        that.resetScrollbar()\n        that.$element.trigger('hidden.bs.modal')\n      })\n    },\n\n    removeBackdrop : function () {\n      this.$backdrop && this.$backdrop.remove()\n      this.$backdrop = null\n    },\n\n    backdrop : function (callback) {\n      var that = this\n      var animate = this.$element.hasClass('fade') ? 'fade' : ''\n\n      if (this.isShown && this.options.backdrop) {\n        var doAnimate = browser.support.transition && animate\n\n        this.$backdrop = $(document.createElement('div'))\n          .addClass('modal-backdrop ' + animate)\n          .appendTo(this.$container)\n\n        if (!this.$container.is(\"body\")) {\n          this.$backdrop.css(\"position\",\"absolute\");\n        }\n\n\n        this.$element.on('click.dismiss.bs.modal', langx.proxy(function (e) {\n          if (this.ignoreBackdropClick) {\n            this.ignoreBackdropClick = false\n            return\n          }\n          if (e.target !== e.currentTarget) return\n          this.options.backdrop == 'static'\n            ? this.$element[0].focus()\n            : this.hide()\n        }, this))\n\n        if (doAnimate) this.$backdrop[0].offsetWidth // force reflow\n\n        this.$backdrop.addClass('in')\n\n        if (!callback) return\n\n        doAnimate ?\n          this.$backdrop\n            .one('transitionEnd', callback)\n            .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n          callback()\n\n      } else if (!this.isShown && this.$backdrop) {\n        this.$backdrop.removeClass('in')\n\n        var callbackRemove = function () {\n          that.removeBackdrop()\n          callback && callback()\n        }\n        browser.support.transition && this.$element.hasClass('fade') ?\n          this.$backdrop\n            .one('transitionEnd', callbackRemove)\n            .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n          callbackRemove()\n\n      } else if (callback) {\n        callback()\n      }\n    },\n\n    // these following methods are used to handle overflowing modals\n\n    handleUpdate : function () {\n      this.adjustDialog()\n    },\n\n    adjustDialog : function () {\n      var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight\n\n      this.$element.css({\n        paddingLeft:  !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',\n        paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''\n      })\n    },\n\n    resetAdjustments : function () {\n      this.$element.css({\n        paddingLeft: '',\n        paddingRight: ''\n      })\n    },\n\n    checkScrollbar : function () {\n      var fullWindowWidth = window.innerWidth\n      if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8\n        var documentElementRect = document.documentElement.getBoundingClientRect()\n        fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)\n      }\n      this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth\n      this.scrollbarWidth = this.measureScrollbar()\n    },\n\n    setScrollbar : function () {\n      var bodyPad = parseInt((this.$container.css('padding-right') || 0), 10)\n      this.originalBodyPad = document.body.style.paddingRight || ''\n      if (this.bodyIsOverflowing) this.$container.css('padding-right', bodyPad + this.scrollbarWidth)\n    },\n\n    resetScrollbar : function () {\n      this.$container.css('padding-right', this.originalBodyPad)\n    },\n\n    measureScrollbar : function () { // thx walsh\n      var scrollDiv = document.createElement('div')\n      scrollDiv.className = 'modal-scrollbar-measure'\n      this.$container.append(scrollDiv)\n      var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth\n      this.$container[0].removeChild(scrollDiv)\n      return scrollbarWidth\n    }\n\n  });  \n\n\n  Modal.VERSION  = '3.3.7'\n\n  Modal.TRANSITION_DURATION = 300\n  Modal.BACKDROP_TRANSITION_DURATION = 150\n\n  Modal.DEFAULTS = {\n    backdrop: true,\n    keyboard: true,\n    show: true\n  }\n\n  /*\n\n  // MODAL PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option, _relatedTarget) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.modal')\n      var options = langx.mixin({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))\n      if (typeof option == 'string') data[option](_relatedTarget)\n      else if (options.show) data.show(_relatedTarget)\n    })\n  }\n\n  var old = $.fn.modal\n\n  $.fn.modal             = Plugin;\n  $.fn.modal.Constructor = Modal;\n\n\n  // MODAL NO CONFLICT\n  // =================\n\n  $.fn.modal.noConflict = function () {\n    $.fn.modal = old\n    return this\n  }\n\n\n  return $.fn.modal;\n  */\n\n  plugins.register(Modal);\n\n  $.fn.modal = function(options,_relatedTarget) {\n    return this.each(function () {\n      var $this   = $(this)\n      var plugin    = plugins.instantiate(this,'bs3.modal',\"instance\");\n      var options = langx.mixin({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!plugin && options.toggle && /show|hide/.test(option)) options.toggle = false\n      if (!plugin) {\n          plugin = plugins.instantiate(this,'bs3.modal',options);\n      }\n      if (typeof option == 'string') {\n        plugin[option](_relatedTarget);\n      } else if (options.show) {\n        plugin.show(_relatedTarget);\n      }\n    });\n  };\n\n  return Modal;\n\n});\n"]}